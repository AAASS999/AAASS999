SELECT user
FROM friends
GROUP BY user
HAVING count(*) < 4;



----------   вывод  список имен .   какие  имена  имеют друзей  минус  совпадения 
SELECT u1.name, u2.name
FROM friends f
LEFT JOIN users u1 ON f.user=u1.id
LEFT JOIN users u2 ON f.friend=u2.id
LEFT JOIN friends o ON f.user=o.friend AND f.friend=o.user
WHERE o.user IS NOT NULL AND f.user<f.friend
